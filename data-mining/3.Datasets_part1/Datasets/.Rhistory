setwd("G:/O meu disco/Profissional/FEUP/Ensino/Business_analytics/Aula_finais/Classification/Classification_techniques/Datasets")
library(readxl)
library(PresenceAbsence)
library(rattle)
library(pROC)
library(caret)
Data =read_excel('Classify_risk_dataset.xlsx', 1)
Data<-data.frame(Data)
levels(Data$RISK)<-c(1,0)
#install.packages('FNN')
library(FNN)
Data$GENDER<-NULL
Data$MARITAL<-NULL
Data$HOWPAID<-NULL
Data$MORTGAGE<-NULL
#######################
#normalize data
new_max<-1
new_min<-0
norm <- function(x) {(x - min(x, na.rm=TRUE))/(max(x,na.rm=TRUE) - min(x, na.rm=TRUE))*((new_max-new_min)+new_min)}
Data_norm<-Data
Data_norm[,-c(1,8)] <- apply(Data[,-c(1,8)],2, norm)
##########################################################################
##########################################################################
#######Parameter Tuning ############
#create stratified train and test samples
library(splitTools)
library(caret)
#split data in a stratified way; define the rows that will take part of each partition
partitions <- partition(Data_norm$RISK, p = c(train_validation = 0.8, test = 0.2))
Test_sample <- data.frame()
Train_validation_sample <- data.frame()
Train_validation_sample <- Data_norm[partitions$train_validation,]
Test_sample <- Data_norm[partitions$test,]
num_folds<-10
max_num_neighbours<-40
set.seed(123)
folds <- createFolds(Train_validation_sample$RISK, k=num_folds)
performance_summary<-data.frame()
max_num_neighbours=2
Model_knn<-knn(Train_validation_sample[-folds[[k]],-c(1,8)], Train_validation_sample[folds[[k]],-c(1,8)], Train_validation_sample[-folds[[k]],8], k = j, prob=TRUE)
k=3
Model_knn<-knn(Train_validation_sample[-folds[[k]],-c(1,8)], Train_validation_sample[folds[[k]],-c(1,8)], Train_validation_sample[-folds[[k]],8], k = j, prob=TRUE)
j=1
Model_knn<-knn(Train_validation_sample[-folds[[k]],-c(1,8)], Train_validation_sample[folds[[k]],-c(1,8)], Train_validation_sample[-folds[[k]],8], k = j, prob=TRUE)
str(Model_knn)
summary(Model_OneR)
#######################################Overfitting#####################################
##Define directory
setwd("G:/O meu disco/Profissional/FEUP/Ensino/Business_analytics/Aula_finais/Classification/Classification_performance/Datasets")
#install.packages("xlsx")
library(readxl)
Data =read_excel('Classify_risk_dataset.xlsx')
Data=data.frame(Data)
summary(Data)
str(Data)
######
cat_var<-c("GENDER","MARITAL","HOWPAID", "MORTGAGE","RISK" )
num_var<-c("ID", "AGE", "INCOME", "NUMKIDS", "NUMCARDS", "STORECAR", "LOANS")
cat_var<-c("GENDER","MARITAL","HOWPAID", "MORTGAGE" )
num_var<-c("ID", "AGE", "INCOME", "NUMKIDS", "NUMCARDS", "STORECAR", "LOANS")
Data[,cat_var]<-data.frame(lapply(Data[,cat_var], as.factor))
summary(Data)
####
#install.packages('OneR')
library(OneR)
Model_OneR<-OneR(Data[,-c(1)])
#OneR(data, formula = NULL)
#data is dataframe, which contains the data. When formula = NULL (the default) the last column must be the target variable
summary(Model_OneR)
prediction <- predict(Model_OneR, Data[,-c(1)])
table(prediction, Data$RISK)
##
accuracy<-sum(prediction== Data$RISK)/nrow(Data)
accuracy
cat_var<-c("GENDER","MARITAL","HOWPAID", "MORTGAGE" )
num_var<-c("ID", "AGE", "INCOME", "NUMKIDS", "NUMCARDS", "STORECAR", "LOANS")
Data[,cat_var]<-data.frame(lapply(Data[,cat_var], as.factor))
summary(Data)
####
#install.packages('OneR')
library(OneR)
Model_OneR<-OneR(Data[,-c(1)])
#OneR(data, formula = NULL)
#data is dataframe, which contains the data. When formula = NULL (the default) the last column must be the target variable
summary(Model_OneR)
#######################################Overfitting#####################################
##Define directory
setwd("G:/O meu disco/Profissional/FEUP/Ensino/Business_analytics/Aula_finais/Classification/Classification_performance/Datasets")
#install.packages("xlsx")
library(readxl)
Data =read_excel('Classify_risk_dataset.xlsx')
Data=data.frame(Data)
summary(Data)
str(Data)
######
cat_var<-c("GENDER","MARITAL","HOWPAID", "MORTGAGE" )
num_var<-c("ID", "AGE", "INCOME", "NUMKIDS", "NUMCARDS", "STORECAR", "LOANS")
Data[,cat_var]<-data.frame(lapply(Data[,cat_var], as.factor))
summary(Data)
####
#install.packages('OneR')
library(OneR)
Model_OneR<-OneR(Data[,-c(1,2)])
#OneR(data, formula = NULL)
#data is dataframe, which contains the data. When formula = NULL (the default) the last column must be the target variable
summary(Model_OneR)
#######################################Overfitting#####################################
##Define directory
setwd("G:/O meu disco/Profissional/FEUP/Ensino/Business_analytics/Aula_finais/Classification/Classification_performance/Datasets")
#install.packages("xlsx")
library(readxl)
Data =read_excel('Classify_risk_dataset.xlsx')
Data=data.frame(Data)
summary(Data)
str(Data)
######
cat_var<-c("GENDER","MARITAL","HOWPAID", "MORTGAGE" )
num_var<-c("ID", "AGE", "INCOME", "NUMKIDS", "NUMCARDS", "STORECAR", "LOANS")
Data[,cat_var]<-data.frame(lapply(Data[,cat_var], as.factor))
summary(Data)
####
#install.packages('OneR')
library(OneR)
Model_OneR<-OneR(Data[,-c(1,6)])
#OneR(data, formula = NULL)
#data is dataframe, which contains the data. When formula = NULL (the default) the last column must be the target variable
summary(Model_OneR)
